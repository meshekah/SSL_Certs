DROP TABLE IF EXISTS `revoked`;
DROP TABLE IF EXISTS `Google_CRLSet`;
CREATE TABLE `Google_CRLSet` (  `id` int(11) NOT NULL AUTO_INCREMENT,  `SHA_of_issuer` varchar(64) NOT NULL,  PRIMARY KEY (`id`)) ENGINE=InnoDB AUTO_INCREMENT=246 DEFAULT CHARSET=utf8;
DROP TABLE IF EXISTS `certs_auths`;
DROP TABLE IF EXISTS `certs_crls`;
DROP TABLE IF EXISTS `ssl_connecs`;
DROP TABLE IF EXISTS `certs`;
DROP TABLE IF EXISTS `authority`;
CREATE TABLE `authority` (  `auth_id` int(11) NOT NULL AUTO_INCREMENT,  `auth_uri` varchar(255) DEFAULT NULL,  `top` tinyint(4) NOT NULL,  PRIMARY KEY (`auth_id`),  UNIQUE KEY `auth_uri_UNIQUE` (`auth_uri`)) ENGINE=InnoDB AUTO_INCREMENT=4787644 DEFAULT CHARSET=utf8;
DROP TABLE IF EXISTS `names`;
CREATE TABLE `names` (  `name_id` int(11) NOT NULL AUTO_INCREMENT,  `country` varchar(50) DEFAULT NULL,  `org` varchar(255) DEFAULT NULL,  `org_unit` varchar(255) DEFAULT NULL,  `com_name` varchar(255) DEFAULT NULL,  `top` tinyint(4) NOT NULL,  PRIMARY KEY (`name_id`),  UNIQUE KEY `unique_name` (`country`,`org`,`org_unit`,`com_name`)) ENGINE=InnoDB AUTO_INCREMENT=9227373 DEFAULT CHARSET=utf8;
CREATE TABLE `certs` (  `cert_id` int(11) NOT NULL AUTO_INCREMENT,  `serial` varchar(100) NOT NULL,  `alg` varchar(100) NOT NULL,  `key_length` int(11) NOT NULL,  `cert_digest` char(40) NOT NULL,  `issuer_id` int(11) NOT NULL,  `subject_id` int(11) NOT NULL,  `top` tinyint(4) NOT NULL,  `cert_name` varchar(100) NOT NULL,  `is_self_signed` tinyint(4) NOT NULL DEFAULT '0',  `version` int(11) NOT NULL,  `parent_cert_id` int(11) DEFAULT NULL,  `is_CA` tinyint(4) NOT NULL,  `SHA_of_pkinfo` char(64) NOT NULL,  PRIMARY KEY (`cert_id`),  UNIQUE KEY `cert_digest_UNIQUE` (`cert_digest`),  KEY `issuers_certs_fk` (`issuer_id`),  KEY `names_certs_fk` (`subject_id`),  KEY `chain_fk_idx` (`parent_cert_id`),  KEY `serial_idx` (`serial`),  KEY `sha_pkinfo` (`SHA_of_pkinfo`),  CONSTRAINT `chain_fk` FOREIGN KEY (`parent_cert_id`) REFERENCES `certs` (`cert_id`) ON DELETE NO ACTION ON UPDATE NO ACTION,  CONSTRAINT `issuers_certs_fk` FOREIGN KEY (`issuer_id`) REFERENCES `names` (`name_id`) ON DELETE NO ACTION ON UPDATE NO ACTION,  CONSTRAINT `names_certs_fk` FOREIGN KEY (`subject_id`) REFERENCES `names` (`name_id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE=InnoDB AUTO_INCREMENT=5386329 DEFAULT CHARSET=utf8;
CREATE TABLE `certs_auths` (  `auth_id` int(11) NOT NULL,  `cert_id` int(11) NOT NULL,  PRIMARY KEY (`auth_id`,`cert_id`),  KEY `fk_cert_id_idx` (`cert_id`),  KEY `fk_auth_uri_idx` (`auth_id`),  CONSTRAINT `fk_auth_uri` FOREIGN KEY (`auth_id`) REFERENCES `authority` (`auth_id`) ON DELETE NO ACTION ON UPDATE NO ACTION,  CONSTRAINT `fk_cert_id` FOREIGN KEY (`cert_id`) REFERENCES `certs` (`cert_id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE=InnoDB DEFAULT CHARSET=utf8;
DROP TABLE IF EXISTS `crl_revoked`;
DROP TABLE IF EXISTS `crls`;
DROP TABLE IF EXISTS `crls_uri`;
CREATE TABLE `crls_uri` (  `crl_uri_id` int(11) NOT NULL AUTO_INCREMENT,  `crl_uri` varchar(255) DEFAULT NULL,  `top` tinyint(4) NOT NULL,  PRIMARY KEY (`crl_uri_id`),  UNIQUE KEY `crl_uri_UNIQUE` (`crl_uri`)) ENGINE=InnoDB AUTO_INCREMENT=4520391 DEFAULT CHARSET=utf8;
CREATE TABLE `certs_crls` (  `crl_uri_id` int(11) NOT NULL,  `cert_id` int(11) NOT NULL,  PRIMARY KEY (`crl_uri_id`,`cert_id`),  KEY `fk_crl_uri_idx` (`crl_uri_id`),  KEY `fk_cert_idx` (`cert_id`),  CONSTRAINT `fk_cert` FOREIGN KEY (`cert_id`) REFERENCES `certs` (`cert_id`) ON DELETE NO ACTION ON UPDATE NO ACTION,  CONSTRAINT `fk_crl_uri` FOREIGN KEY (`crl_uri_id`) REFERENCES `crls_uri` (`crl_uri_id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE=InnoDB DEFAULT CHARSET=utf8;
CREATE TABLE `crls` (  `crl_id` int(11) NOT NULL AUTO_INCREMENT,  `crl_uri_id` int(11) NOT NULL,  `num_of_revoked` int(11) NOT NULL,  `crl_size` int(11) NOT NULL,  `crl_digest` char(224) NOT NULL,  `rNone` int(11) NOT NULL,  `unspecified` int(11) NOT NULL,  `keyCompromise` int(11) NOT NULL,  `cACompromise` int(11) NOT NULL,  `affiliationChanged` int(11) NOT NULL,  `superseded` int(11) NOT NULL,  `cessationOfOperation` int(11) NOT NULL,  `certificateHold` int(11) NOT NULL,  `removeFromCRL` int(11) NOT NULL,  `privilegeWithdrawn` int(11) NOT NULL,  `aACompromise` int(11) NOT NULL,  `wrong` int(11) NOT NULL,  PRIMARY KEY (`crl_id`),  UNIQUE KEY `crl_digest_UNIQUE` (`crl_digest`),  KEY `crls_uri_crls_fk` (`crl_uri_id`),  CONSTRAINT `crls_uri_crls_fk` FOREIGN KEY (`crl_uri_id`) REFERENCES `crls_uri` (`crl_uri_id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE=InnoDB AUTO_INCREMENT=6844 DEFAULT CHARSET=utf8;
CREATE TABLE `crl_revoked` (  `crl_id` int(11) NOT NULL,  `serial` varchar(100) NOT NULL,  `reason` tinyint(4) NOT NULL,  PRIMARY KEY (`crl_id`,`serial`),  KEY `crl_id_fk_idx` (`crl_id`),  CONSTRAINT `crl_id_fk` FOREIGN KEY (`crl_id`) REFERENCES `crls` (`crl_id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE=InnoDB DEFAULT CHARSET=utf8;
CREATE TABLE `revoked` (  `issuer_id` int(11) NOT NULL,  `serial` varchar(100) NOT NULL,  PRIMARY KEY (`issuer_id`,`serial`),  KEY `serial_idx` (`serial`),  CONSTRAINT `issuer_id_fk` FOREIGN KEY (`issuer_id`) REFERENCES `Google_CRLSet` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE=InnoDB DEFAULT CHARSET=utf8;
CREATE TABLE `ssl_connecs` (  `conn_id` int(11) NOT NULL AUTO_INCREMENT,  `protocol` varchar(50) DEFAULT NULL,  `cipher` varchar(50) DEFAULT NULL,  `cert_id` int(11) DEFAULT NULL,  `top` tinyint(4) NOT NULL,  `uri` varchar(255) NOT NULL,  `verify_code` int(11) DEFAULT NULL,  `verify_msg` varchar(50) DEFAULT NULL,  PRIMARY KEY (`conn_id`),  UNIQUE KEY `uri_UNIQUE` (`uri`),  KEY `certs_ssl_connec_fk` (`cert_id`),  CONSTRAINT `certs_ssl_connec_fk` FOREIGN KEY (`cert_id`) REFERENCES `certs` (`cert_id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE=InnoDB AUTO_INCREMENT=2775945 DEFAULT CHARSET=utf8 COMMENT='This hold the information per SSL connection to a website.';